.. _data-privacy:

Конфиденциальность данных
=============================

Блокчейн-платформа Восток позволяет организовать передачу и хранение конфиденциальных данных между участниками сетевого взаимодействия. Защита конфиденциальных данных при их передаче и хранении обеспечивается набором политик (policy), которые содержат список участников и регулируют отношения сторон в рамках взаимодействия с приватными данными.

.. image:: img/policy-1.png
       :align: center

Описание политики доступа
------------------------------

Как правило, политика доступа создаётся участниками, которым необходимо обмениваться приватными данными. Политику доступа может создать любая нода-участник сети и включить в неё любой состав других нод сети. Политика представляет собой таблицу в стейте ноды, содержащую поля с парами "Ключ" и "Значение". Ключ - это идентификатор политики (policyId), равный идентификатору транзакции ее создавшей, значение - это массив с полями:

* автор политики (sender);
* описание политики (description);
* срок действия политики (dueDate);
* список с адресами получателей конфиденциальных данных (recipients);
* список с адресами участников с правами редактирования политики (owners);
* список с транзакциями, в которых передаются хэши от данных (txs).

Политика имеет следующие параметры:

* описание (policyDescription);
* срок действия (policyDueDate);
* список получателей конфиденциальных данных (policyRecipients);
* список участников с правами на редактирование политики (policyOwners).

Создание политики доступа происходит при помощи отправки в блокчейн транзакции :ref:`CreatePolicyTransaction <CreatPolicyTransaction>` (type = 112, создание политики) со следующими параметрами:

* отправитель (sender);
* описание (description);
* дата и время (timestamp);
* получатели (recipients);
* владельцы (owners).

Владельцы политики имеют право изменять политику доступа. Для изменения политики доступа необходимо отправить в блокчейн транзакцию :ref:`UpdatePolicyTransaction <UpdatePolicyTransaction>` (type = 113, редактирование политики) со следующими параметрами:

* идентификатор политики (policyId);
* отправитель (sender);
* дата и время (timestamp);
* добавление/удаление участников (opType);
* получатели (recipients);
* владельцы (owners).

Для внешних приложений в :ref:`API ноды <privacy-api>` реализовано запросы, возвращающие сведения по политике и данным, которые передаются в рамках данной политики: ``GET /privacy/{policy}/recipients``, ``GET /privacy/{policy}/fullinfo``, ``GET /privacy/{policy}/getHashes``, 
``GET /privacy/getInfo/{hash}``.


Маршрутизация данных
--------------------------

Для обмена конфиденциальными данными участники сетевого взамиодействия (ноды) должны пройти обязательную регистрацию. Регистрация ноды выполняется отправкой специальной транзакции :ref:`RegistrationNodeTransaction <transaction-structure>` (type = 111), доступной только для пользователя с ролью "connection-manager". Регистрация нового участника в сети описано на :ref:`этой странице<privacy-using>`.

Транзакция содержит следующие параметры:

- публичный ключ ноды;
- название или описание ноды.

На основе указанных параметров в стейте ноды формируется таблица разрешенных участников сетевого обмена. Взаимодействие между нодами разрешается, если в запросе ноды (:ref:`handshake message <network-message>`) присутствует подпись на приватном ключе, парном публичному ключу, который находится в стейте ноды. Если подпись запроса верна, то нода формирует в своей памяти таблицу, содержащую соотвествие между блокчейн-адресом участника отправившего handshake запрос и его hostname/ip-адресом. После успешного подключения нода пользователя выполняет синхронизацию с сетью, а так же синхронизацию таблицы адресов участников.
